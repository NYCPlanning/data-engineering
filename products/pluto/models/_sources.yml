version: 2

sources:
- name: recipe_sources
  schema: "{{ env_var('BUILD_ENGINE_SCHEMA') }}"
  tables:
  - name: pluto_input_research
  - name: pluto_input_cama_dof
  - name: pluto_input_geocodes
  - name: pluto_input_numbldgs
  - name: pluto_pts
  - name: dcp_mappluto
  - name: lpc_landmarks
  - name: lpc_historic_districts
  - name: dcp_edesignation
  - name: dcp_councildistricts_wi
  - name: dcp_cb2010_wi
  - name: dcp_cb2020_wi
  - name: dcp_ct2010_wi
  - name: dcp_ct2020_wi
  - name: dcp_cdboundaries_wi
  - name: doitt_zipcodeboundaries
  - name: dcp_school_districts
  - name: dcp_zoningdistricts
  - name: dcp_commercialoverlay
  - name: dcp_limitedheight
  - name: dcp_specialpurpose
  - name: dcp_specialpurposesubdistricts
  - name: dcp_zoningmapamendments
  - name: dcp_zoningmapindex
  - name: dcp_firecompanies
  - name: dcp_policeprecincts
  - name: dcp_healthareas
  - name: dcp_healthcenters
  - name: dsny_frequencies
  - name: dcp_colp
  - name: dpr_greenthumb
  - name: dof_condo
  - name: dof_dtm
  - name: dof_shoreline
  - name: fema_firms2007_100yr
  - name: fema_pfirms2015_100yr
  - name: dcp_transit_zones
  - name: dcp_gis_mandatory_inclusionary_housing
  - name: dcp_developments
    description: >-
      Contains changes in units resulting from new buildings, major alterations, and
      demolitions. This table is used for cross-checking condo unit count with PLUTO
      input data.
    columns:
    - name: bbl
    - name: bin
    - name: units_co
    - name: classa_prop
    - name: job_type
      data_tests:
      - name: source_dcp_developments_job_type_values
        test_name: accepted_values
        arguments:
          values:
            [
              "Alteration",
              "Alteration (A2)",
              "Alteration (Non-CO)",
              "Demolition",
              "New Building"
            ]
    - name: job_status
      data_tests:
      - name: source_dcp_developments_job_status_values
        test_name: accepted_values
        arguments:
          values:
            [
              "1. Filed Application",
              "2. Approved Application",
              "3. Permitted for Construction",
              "4. Partially Completed Construction",
              "5. Completed Construction",
              "9. Withdrawn"
            ]
    - name: date_complete

  - name: pluto_pts

- name: build_sources
  schema: "{{ env_var('BUILD_ENGINE_SCHEMA') }}"
  tables:
  - name: dof_pts_propmaster
    description: Raw PTS data + prime bbl column that was added during PLUTO build.
  - name: pluto_rpad_geo
    description: >-
      Processed PTS data where each record is a UNIT BBL: i.e. there are multiple
      records per a condominium.

  - name: previous_pluto
  - name: export_pluto
    description: final PLUTO table
  - name: dcp_zoningdistricts
  - name: dcp_zoning_maxfar
