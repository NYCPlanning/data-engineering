models:
- name: int__segment_specialaddress
  columns:
  - name: segmentid
  - name: boroughcode
  - name: special_address_flag

- name: int__segment_locational_status
  description: |
    Centerline segments with Locational Status & Borough Boundary Indicator columns.
  columns:
  - name: segmentid
    tests:
    - not_null
  # TODO disable test for now, failing for one record
  # - unique
  - name: borough_boundary_indicator
    tests:
    - test_name: accepted_values
      arguments:
        values: [ 'R', 'L' ]
  - name: is_ap_boro_boundary_error
    tests:
    - test_name: accepted_values
      arguments:
        values: [ false ]
      config:
        severity: warn
  - name: segment_locational_status
    tests:
    - test_name: accepted_values
      arguments:
        values: [ '9', 'H', 'I', '1', '2', '3', '4', '5', 'X' ]
  data_tests:
  - test_name: dbt_expectations.expect_table_row_count_to_equal_other_table
    arguments:
      compare_model: ref("int__segment_atomicpolygons")
