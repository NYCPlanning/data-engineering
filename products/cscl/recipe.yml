name: CSCL
product: cscl
version: 25d

inputs:
  dataset_defaults:
    destination: postgres
    file_type: gdb
    source: edm.recipes.raw_datasets
    load_engine: gdal
  missing_versions_strategy: find_latest # TODO - they should all match
  datasets:
  # segment source layers - backbone
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_centerline
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: Centerline
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_shoreline
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: Shoreline
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_rail
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: Rail
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_subway
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: Subway
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_nonstreetfeatures
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: NonStreetFeature

  # other more "primary" layers
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_atomicpolygons
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: AtomicPolygon
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_nodes
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: Node

  # all other tables
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_addresspoints
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: AddressPoint
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_addresspoint_lgcs
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: ADDRESSPOINTLGCS
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_altsegmentdata
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: ALTSEGMENTDATA
  - name: dcp_cscl_gdb # TODO - we archive commonplace from AGOL as well, at some point this duplication should be resolved
    import_as: dcp_cscl_commonplace_gdb
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: CommonPlace
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_featurename
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: FEATURENAME
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_lastword
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: LASTWORD
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_namedintersection
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: NAMEDINTERSECTION
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_nypdbeat
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: NYPDBeat
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_nypdprecinct
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: NYPDPrecinct
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_nypdpatrolborough
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: NYPDPatrolBorough
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_censustract2010
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: CensusTract2010
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_censustract2020
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: CensusTract2020
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_healtharea
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: HealthArea
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_roadbed_pointer_list
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: RoadbedPointerList
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_sectionalmap
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: SectionalMap
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_sedat
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: SEDAT
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_segment_lgc
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: SEGMENT_LGC
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_specialsedat
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: SPECIALSEDAT
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_streetname
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: STREETNAME
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_universalword
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: UNIVERSALWORD
  - name: dcp_cscl_gdb
    import_as: dcp_cscl_zipcode
    custom:
      filename: ETL Working GDB.gdb.zip
      layer_name: ZipCode
  missing_versions_strategy: find_latest # TODO - they should all match

exports:
  output_folder: output
  zip_name: output
  datasets:
  # GeoSupport LION
  - name: manhattan_lion_dat
    filename: ManhattanLION.dat
    format: dat
    custom: { formatting: lion_dat }
  - name: bronx_lion_dat
    filename: BronxLION.dat
    format: dat
    custom: { formatting: lion_dat }
  - name: brooklyn_lion_dat
    filename: BrooklynLION.dat
    format: dat
    custom: { formatting: lion_dat }
  - name: queens_lion_dat
    filename: QueensLION.dat
    format: dat
    custom: { formatting: lion_dat }
  - name: staten_island_lion_dat
    filename: StatenIslandLION.dat
    format: dat
    custom: { formatting: lion_dat }

  # SAF
  - name: saf_abcegnpx_generic
    filename: GenericABCEGNPX.txt
    format: dat
    custom: { formatting: saf_a }
  - name: saf_abcegnpx_roadbed
    filename: RoadbedABCEGNPX.txt
    format: dat
    custom: { formatting: saf_a }
  - name: saf_d_generic
    filename: GenericD.txt
    format: dat
    custom: { formatting: saf_d }
  - name: saf_d_roadbed
    filename: RoadbedD.txt
    format: dat
    custom: { formatting: saf_d }
  - name: saf_i
    filename: Intersection.txt
    format: dat
    custom: { formatting: saf_i }
  - name: saf_ov_generic
    filename: GenericOV.txt
    format: dat
    custom: { formatting: saf_v }
  - name: saf_ov_roadbed
    filename: RoadbedOV.txt
    format: dat
    custom: { formatting: saf_v }
  - name: saf_s_generic
    filename: GenericS.txt
    format: dat
    custom: { formatting: saf_s }
  - name: saf_s_roadbed
    filename: RoadbedS.txt
    format: dat
    custom: { formatting: saf_s }

  # SEDAT
  - name: sedat
    filename: SEDAT.txt
    format: dat
    custom: { formatting: sedat }
  - name: special_sedat
    filename: SpecialSEDAT.txt
    format: dat
    custom: { formatting: sedat }

  # SND, Geosupport Normalizing Tables
  - name: snd
    filename: SND.txt
    format: dat
    custom: { formatting: snd }
  - name: exception
    filename: Exception.txt
    format: dat
  - name: universal_word
    filename: Universal.txt
    format: csv
    custom:
      header: False
      line_endings: crlf
  - name: last_word
    filename: LastWord.txt
    format: csv
    custom:
      header: False
      line_endings: crlf
  - name: enders
    filename: Enders.txt
    format: dat

  # Face Code
  - name: manhattan_face_code
    filename: ManhattanFace.txt
    format: dat
    custom: { formatting: face_code }
  - name: bronx_face_code
    filename: BronxFace.txt
    format: dat
    custom: { formatting: face_code }
  - name: brooklyn_face_code
    filename: BrooklynFace.txt
    format: dat
    custom: { formatting: face_code }
  - name: queens_face_code
    filename: QueensFace.txt
    format: dat
    custom: { formatting: face_code }
  - name: staten_island_face_code
    filename: StatenIslandFace.txt
    format: dat
    custom: { formatting: face_code }

  # Thin LION
  - name: thin_lion
    filename: nyc.thinlion
    format: dat
    custom: { formatting: thinlion_dat }
  - name: bronx_thin_lion
    filename: BronxThinLION.txt
    format: dat
    custom: { formatting: thinlion_dat }
  - name: brooklyn_thin_lion
    filename: BrooklynThinLION.txt
    format: dat
    custom: { formatting: thinlion_dat }
  - name: manhattan_thin_lion
    filename: ManhattanThinLION.txt
    format: dat
    custom: { formatting: thinlion_dat }
  - name: queens_thin_lion
    filename: QueensThinLION.txt
    format: dat
    custom: { formatting: thinlion_dat }
  - name: staten_island_thin_lion
    filename: StatenIslandThinLION.txt
    format: dat
    custom: { formatting: thinlion_dat }
