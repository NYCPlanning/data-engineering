id: pluto_pts
acl: public-read

attributes:
  name: PTS - DOF
  description: pluto_pts is a input into PLUTO, we receive this over sftp

ingestion:
  source:
    type: ginger
    path: Prod_FromDOF/PTS_Propmast.gz
  file_format:
    type: csv
    delimiter: "\t"
    dtype: str # we don't necessarily need this, but it keeps consistent with library archival
    names:
    - parid
    - boro
    - block
    - lot
    - ease
    - subident_reuc
    - rectype
    - av_year4
    - ident
    - subident
    - roll_section
    - secvol
    - pymktland
    - pymkttot
    - pyactland
    - pyacttot
    - pyactextot
    - pytrnland
    - pytrntot
    - pytrnextot
    - pytxbtot
    - pytxbextot
    - pytaxclass
    - tenmktland
    - tenmkttot
    - tenactland
    - tenacttot
    - tenactextot
    - tentrnland
    - tentrntot
    - tentrnextot
    - tentxbtot
    - tentxbextot
    - tentaxclass
    - cbnmktland
    - cbnmkttot
    - cbnactland
    - cbnacttot
    - cbnactextot
    - cbntrnland
    - cbntrntot
    - cbntrnextot
    - cbntxbtot
    - cbntxbextot
    - cbntaxclass
    - finmktland
    - finmkttot
    - finactland
    - finacttot
    - finactextot
    - fintrnland
    - fintrntot
    - fintrnextot
    - fintxbtot
    - fintxbextot
    - fintaxclass
    - curmktland
    - curmkttot
    - curactland
    - curacttot
    - curactextot
    - curtrnland
    - curtrntot
    - curtrnextot
    - curtxbtot
    - curtxbextot
    - curtaxclass
    - period
    - newdrop
    - noav
    - valref
    - bldg_class
    - av_owner
    - zoning
    - housenum_lo
    - housenum_hi
    - street_name
    - zip_code
    - geosupport_rc
    - stcode
    - lot_frt
    - lot_dep
    - lot_irreg
    - bld_frt
    - bld_dep
    - bld_ext
    - bld_story
    - corner
    - land_area
    - num_bldgs
    - yrbuilt
    - yrbuilt_range
    - yrbuilt_flag
    - yralt1
    - yralt1_range
    - yralt2
    - yralt2_range
    - coop_apts
    - units
    - reuc_ref
    - aptno
    - coop_num
    - cpb_boro
    - cpb_dist
    - appt_date
    - appt_boro
    - appt_block
    - appt_lot
    - appt_ease
    - condo_number
    - condo_sfx1
    - condo_sfx2
    - condo_sfx3
    - uaf_land
    - uaf_bldg
    - protest_1
    - protest_2
    - protest_old
    - attorney_group1
    - attorney_group2
    - attorney_group_old
    - gross_sqft
    - hotel_area_gross
    - office_area_gross
    - residential_area_gross
    - retail_area_gross
    - loft_area_gross
    - factory_area_gross
    - warehouse_area_gross
    - storage_area_gross
    - garage_area
    - other_area_gross
    - reuc_description
    - extractdt
    - pytaxflag
    - tentaxflag
    - cbntaxflag
    - fintaxflag
    - curtaxflag
  processing_steps:
  - name: filter_columns
    args:
      columns:
      - boro
      - block
      - lot
      - street_name
      - housenum_lo
      - housenum_hi
      - aptno
      - zip_code
      - bldg_class
      - ease
      - av_owner
      - land_area
      - gross_sqft
      - residential_area_gross
      - office_area_gross
      - retail_area_gross
      - garage_area
      - storage_area_gross
      - factory_area_gross
      - other_area_gross
      - num_bldgs
      - bld_story
      - coop_apts
      - units
      - lot_frt
      - lot_dep
      - bld_frt
      - bld_dep
      - bld_ext
      - lot_irreg
      - curactland
      - curacttot
      - curactextot
      - yrbuilt
      - yralt1
      - yralt2
      - condo_number
      - appt_boro
      - appt_block
      - appt_lot
      - appt_ease
      - appt_date
      - parid
  - name: strip_columns
  - name: pd_series_func
    args:
      function_name: str.replace
      column_name: av_owner
      pat: "\""
      repl: ""
