name: Docker Images - Build and Publish
on:
  workflow_dispatch:
    inputs:
      build-base:
        description: "Build 'build-base' image"
        type: boolean
        required: true
        default: false
      build-geosupport:
        description: "Build 'build-geosupport' image"
        type: boolean
        required: true
        default: false
      dev:
        description: "Build 'dev' image"
        type: boolean
        required: true
        default: false
      docker-geosupport:
        description: "Build 'docker-geosupport' image"
        type: boolean
        required: true
        default: false

env:
  DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
  DOCKER_USER: ${{ secrets.DOCKER_USER }}

jobs:
  build-base:
    runs-on: ubuntu-22.04
    if: inputs.build-base
    defaults:
      run:
        shell: bash
        working-directory: docker
    steps:
      - uses: actions/checkout@v3
        
      - name: Build and publish build-base
        run: ./publish.sh build-base 

  build-geosupport:
    runs-on: ubuntu-22.04
    if: inputs.build-geosupport
    defaults:
      run:
        shell: bash
        working-directory: docker
    steps:
      - uses: actions/checkout@v3
        
      - name: Build and publish build-geosupport
        run: ./publish.sh build-geosupport

  dev:
    runs-on: ubuntu-22.04
    if: inputs.dev
    defaults:
      run:
        shell: bash
        working-directory: docker
    steps:
      - uses: actions/checkout@v3
        
      - name: Build and publish dev
        run: ./publish.sh dev 

  docker-geosupport:
    runs-on: ubuntu-22.04
    if: inputs.docker-geosupport
    defaults:
      run:
        shell: bash
        working-directory: docker
    steps:
      - uses: actions/checkout@v3
        
      - name: Build and publish docker-geosupport
        run: ./publish.sh docker-geosupport 
