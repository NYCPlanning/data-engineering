version: 2

models:
- name: lion_dat_by_field
  description: lion with individual fields formatted for export
  config:
    contract:
      enforced: true
  columns:
  - name: boroughcode
    data_type: string
    tests:
    - not_null
    # TODO disable test for now
    # - accepted_values:
    #     # this enforces length as well
    #     values: [ "1", "2", "3", "4", "5" ]
  - name: face_code
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: segment_seqnum
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 5 }
  - name: segmentid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: five_digit_street_code
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 5 }
  - name: lgc1
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: lgc2
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: lgc3
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: lgc4
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: boe_lgc_pointer
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: from_sectionalmap
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: from_nodeid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: from_x
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: from_y
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: to_sectionalmap
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: to_nodeid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: to_x
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: to_y
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: left_2000_census_tract_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: left_2000_census_tract_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: left_dynamic_block
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 3 }
  - name: l_low_hn
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: l_high_hn
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: lsubsect
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: l_zip
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 5 }
  - name: left_assembly_district
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: left_election_district
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 3 }
  - name: left_school_district
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: right_2000_census_tract_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: right_2000_census_tract_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: right_dynamic_block
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 3 }
  - name: r_low_hn
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: r_high_hn
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: rsubsect
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: r_zip
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 5 }
  - name: right_assembly_district
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: right_election_district
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 3 }
  - name: right_school_district
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: split_election_district_flag
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: filler_l38
    data_type: string
    tests:
    - not_null
    - accepted_values:
        arguments:
          values: [ " " ]
  - name: sandist_ind
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: traffic_direction
    data_type: string
    tests:
    - not_null
    - accepted_values:
        arguments:
          # this enforces length as well
          values: [ " ", "W", "A", "P", "T" ]
  - name: segment_locational_status
    data_type: string
    tests:
    - not_null
    - accepted_values:
        arguments:
          # this enforces length as well
          values: [ " ", "9", "H", "I", "1", "2", "3", "4", "5", "X" ]
  - name: feature_type_code
    data_type: string
    tests:
    - not_null
    - accepted_values:
        arguments:
          # this enforces length as well
          values: [ " ", "1", "2", "3", "5", "6", "7", "8", "9", "A", "W", "F", "C" ]
  - name: nonped
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: continuous_parity_flag
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: filler_l45
    data_type: string
    tests:
    - not_null
    - accepted_values:
        arguments:
          values: [ " " ]
  - name: borough_boundary_indicator
    data_type: string
    tests:
    - not_null
    - accepted_values:
        arguments:
          values: [ " ", "R", "L" ]
  - name: twisted_parity_flag
    data_type: string
    tests:
    - not_null
    - accepted_values:
        arguments:
          values: [ " ", "T" ]
  - name: special_address_flag
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: curve_flag
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: center_of_curvature_x
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: center_of_curvature_y
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: segment_length_ft
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 5 }
  - name: from_level_code
    data_type: string
    tests:
    - not_null
    - accepted_values:
        arguments:
          values:
            [
              A,
              B,
              C,
              D,
              E,
              F,
              G,
              H,
              I,
              J,
              K,
              L,
              M,
              N,
              O,
              P,
              Q,
              R,
              S,
              T,
              U,
              V,
              W,
              X,
              Y,
              Z,
              "*",
              $
            ]
  - name: to_level_code
    data_type: string
    tests:
    - not_null
    - accepted_values:
        arguments:
          values:
            [
              A,
              B,
              C,
              D,
              E,
              F,
              G,
              H,
              I,
              J,
              K,
              L,
              M,
              N,
              O,
              P,
              Q,
              R,
              S,
              T,
              U,
              V,
              W,
              X,
              Y,
              Z,
              "*",
              $
            ]
  - name: trafdir_ver_flag
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: segment_type
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: coincident_seg_count
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: incex_flag
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: rw_type
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: physicalid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: genericid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: nypdid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: fdnyid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: filler_l64
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: filler_l65
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: status
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: streetwidth_min
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 3 }
  - name: streetwidth_irr
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: bike_lane_1
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: fcc
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: right_of_way_type
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: left_2010_census_tract_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: left_2010_census_tract_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: right_2010_census_tract_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: right_2010_census_tract_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: lgc5
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: lgc6
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: lgc7
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: lgc8
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: lgc9
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: legacy_segmentid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 7 }
  - name: left_2000_census_block_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: left_2000_census_block_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: right_2000_census_block_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: right_2000_census_block_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: left_2010_census_block_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: left_2010_census_block_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: right_2010_census_block_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: right_2010_census_block_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: snow_priority
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: bike_lane_2
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: streetwidth_max
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 3 }
  - name: filler_l89
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 3 }
  - name: l_blockfaceid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 10 }
  - name: r_blockfaceid
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 10 }
  - name: number_travel_lanes
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: number_park_lanes
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: number_total_lanes
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: bike_traffic_direction
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: posted_speed
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: left_nypd_service_area
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: right_nypd_service_area
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: truck_route_type
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: left_2020_census_tract_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: left_2020_census_tract_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: right_2020_census_tract_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: right_2020_census_tract_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 2 }
  - name: left_2020_census_block_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: left_2020_census_block_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: right_2020_census_block_basic
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 4 }
  - name: right_2020_census_block_suffix
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 1 }
  - name: filler_l199
    data_type: string
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 45 }
  - name: _source_table # TODO remove - see note in model sql file
    data_type: string

- name: lion_dat
  columns:
  - name: dat_column
    tests:
    - dbt_expectations.expect_column_value_lengths_to_equal:
        arguments: { value: 400 }

- name: manhattan_lion_dat
  columns:
  - name: dat_column
