version: 2

models:
- name: int__primary_segments
  columns:
  - name: segmentid
    tests: [ not_null, unique ]

- name: int__protosegments
  columns:
  - name: segmentid
  tests:
  - name: int__protosegments__key_ideal
    test_name: dbt_utils.unique_combination_of_columns
    arguments:
      combination_of_columns:
      - boroughcode
      - face_code
      - segment_seqnum

- name: int__segments
  columns:
  - name: lionkey
    tests: [ unique ]
  - name: segmentid
    tests: [ not_null ]
  - name: feature_type
    tests: [ not_null ]
  - name: globalid
    tests: [ unique ]

- name: int__nonstreetfeature_seqnum
  description: Non-streetfeature segments (and protosegments) with segment seqnum assigned
  columns:
  - name: source_table
  - name: globalid
    tests: [ unique ]
  - name: segmentid
  - name: ogc_fid
  - name: boroughcode
  - name: face_code
  - name: segment_seqnum
  data_tests:
  - name: nsf_seqnum_unique_lionkey
    test_name: dbt_utils.unique_combination_of_columns
    arguments:
      combination_of_columns: [ boroughcode, face_code, segment_seqnum ]
