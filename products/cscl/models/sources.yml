version: 2

sources:
- name: recipe_sources
  schema: "{{ env_var('BUILD_ENGINE_SCHEMA') }}"
  tables:
  # segment source layers - backbone
  - name: dcp_cscl_centerline
  - name: dcp_cscl_shoreline
  - name: dcp_cscl_rail
  - name: dcp_cscl_subway
  - name: dcp_cscl_nonstreetfeatures

  # other more "primary" layers
  - name: dcp_cscl_atomicpolygons
  - name: dcp_cscl_nodes

  # all other tables
  - name: dcp_cscl_addresspoints
  - name: dcp_cscl_addresspoint_lgcs
  - name: dcp_cscl_altsegmentdata
  - name: dcp_cscl_commonplace_gdb # TODO - we archive commonplace from AGOL as well, at some point this duplication should be resolved
  - name: dcp_cscl_featurename
  - name: dcp_cscl_lastword
  - name: dcp_cscl_namedintersection
  - name: dcp_cscl_nypdbeat
  - name: dcp_cscl_roadbed_pointer_list
  - name: dcp_cscl_sectionalmap
  - name: dcp_cscl_sedat
  - name: dcp_cscl_segment_lgc
    tests:
    - dbt_utils.unique_combination_of_columns:
        arguments:
          combination_of_columns:
          - segmentid
          - lgc
        config:
          severity: warn
  - name: dcp_cscl_specialsedat
  - name: dcp_cscl_streetname
  - name: dcp_cscl_universalword
  - name: dcp_cscl_zipcode

# TODO - remove when pipeline is fully operationalized
- name: production_outputs
  schema: production_outputs
  tables:
  - name: citywide_lion_dat
  - name: saf_abcegnpx_generic
  - name: saf_abcegnpx_roadbed
  - name: saf_d_generic
  - name: saf_d_roadbed
  - name: saf_i
  - name: saf_ov_generic
  - name: saf_ov_roadbed
  - name: sedat
  - name: snd
