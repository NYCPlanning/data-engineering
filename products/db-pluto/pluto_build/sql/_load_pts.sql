CREATE TEMP TABLE tmp (
    parid text,
    boro text,
    block text,
    lot text,
    ease text,
    subident_reuc text,
    rectype text,
    av_year4 text,
    ident text,
    subident text,
    roll_section text,
    secvol text,
    pymktland text,
    pymkttot text,
    pyactland text,
    pyacttot text,
    pyactextot text,
    pytrnland text,
    pytrntot text,
    pytrnextot text,
    pytxbtot text,
    pytxbextot text,
    pytaxclass text,
    tenmktland text,
    tenmkttot text,
    tenactland text,
    tenacttot text,
    tenactextot text,
    tentrnland text,
    tentrntot text,
    tentrnextot text,
    tentxbtot text,
    tentxbextot text,
    tentaxclass text,
    cbnmktland text,
    cbnmkttot text,
    cbnactland text,
    cbnacttot text,
    cbnactextot text,
    cbntrnland text,
    cbntrntot text,
    cbntrnextot text,
    cbntxbtot text,
    cbntxbextot text,
    cbntaxclass text,
    finmktland text,
    finmkttot text,
    finactland text,
    finacttot text,
    finactextot text,
    fintrnland text,
    fintrntot text,
    fintrnextot text,
    fintxbtot text,
    fintxbextot text,
    fintaxclass text,
    curmktland text,
    curmkttot text,
    curactland text,
    curacttot text,
    curactextot text,
    curtrnland text,
    curtrntot text,
    curtrnextot text,
    curtxbtot text,
    curtxbextot text,
    curtaxclass text,
    period text,
    newdrop text,
    noav text,
    valref text,
    bldg_class text,
    av_owner text,
    zoning text,
    housenum_lo text,
    housenum_hi text,
    street_name text,
    zip_code text,
    geosupport_rc text,
    stcode text,
    lot_frt text,
    lot_dep text,
    lot_irreg text,
    bld_frt text,
    bld_dep text,
    bld_ext text,
    bld_story text,
    corner text,
    land_area text,
    num_bldgs text,
    yrbuilt text,
    yrbuilt_range text,
    yrbuilt_flag text,
    yralt1 text,
    yralt1_range text,
    yralt2 text,
    yralt2_range text,
    coop_apts text,
    units text,
    reuc_ref text,
    aptno text,
    coop_num text,
    cpb_boro text,
    cpb_dist text,
    appt_date text,
    appt_boro text,
    appt_block text,
    appt_lot text,
    appt_ease text,
    condo_number text,
    condo_sfx1 text,
    condo_sfx2 text,
    condo_sfx3 text,
    uaf_land text,
    uaf_bldg text,
    protest_1 text,
    protest_2 text,
    protest_old text,
    attorney_group1 text,
    attorney_group2 text,
    attorney_group_old text,
    gross_sqft text,
    hotel_area_gross text,
    office_area_gross text,
    residential_area_gross text,
    retail_area_gross text,
    loft_area_gross text,
    factory_area_gross text,
    warehouse_area_gross text,
    storage_area_gross text,
    garage_area text,
    other_area_gross text,
    reuc_description text,
    extractdt text,
    pytaxflag text,
    tentaxflag text,
    cbntaxflag text,
    fintaxflag text,
    curtaxflag text
);

\COPY tmp FROM PSTDIN WITH NULL AS '' DELIMITER E'\t' quote '"' CSV;

DROP TABLE IF EXISTS :NAME CASCADE;
SELECT
    boro,
    block,
    lot,
    street_name,
    housenum_lo,
    housenum_hi,
    aptno,
    zip_code,
    bldg_class,
    ease,
    av_owner,
    land_area,
    gross_sqft,
    residential_area_gross,
    office_area_gross,
    retail_area_gross,
    garage_area,
    storage_area_gross,
    factory_area_gross,
    other_area_gross,
    num_bldgs,
    bld_story,
    coop_apts,
    units,
    lot_frt,
    lot_dep,
    bld_frt,
    bld_dep,
    bld_ext,
    lot_irreg,
    curactland,
    curacttot,
    curactextot,
    yrbuilt,
    yralt1,
    yralt2,
    condo_number,
    appt_boro,
    appt_block,
    appt_lot,
    appt_ease,
    appt_date,
    parid
INTO :NAME FROM tmp;
