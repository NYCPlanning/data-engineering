version: 2

models:
  - name: dataset_versions
    description: |
      List of datasets in CEQR Data Hub and their versions
    columns:
      - name: dataset_name
        tests:
          - not_null
          - unique

      - name: dataset_id
        tests:
          - not_null:
              config: { where: "availability_type = 'download'" }
          - unique

      - name: availability_type
        tests:
          - not_null
          - accepted_values:
              arguments: { values: ["download", "webpage"] }

      - name: file_type
        tests:
          - not_null:
              config: { where: "availability_type = 'download'" }
          - accepted_values:
              arguments: { values: ["shapefile", "csv", "excel"] }
              config: { where: "availability_type = 'download'" }

      - name: geometry_type
        tests:
          - not_null:
              config: { where: "file_type = 'shapefile'" }
          - accepted_values:
              arguments: { values: ["MULTIPOLYGON", "MULTIPOINT", "MULTILINESTRING"] }
              config: { where: "availability_type = 'download'" }

      - name: version
        tests:
          - not_null:
              config: { where: "availability_type = 'download'" }

      - name: source_url
