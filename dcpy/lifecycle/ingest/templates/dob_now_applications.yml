id: dob_now_applications
acl: public-read

attributes:
  name: DOB NOW Job Applications
  description: |
    DOB NOW job applications received from DOB via the DOB FTP which can be accessed via CyberDuck on DCP 
    Windows machines (see internal documentation for credentials). The encoding standard of 
    the file should be double checked before and after uploading to Digital Ocean as it 
    has changed between versions (from "Windows-1252" to "utf-8", etc).
    
    There is an extensive writeup in a github issue about DOB NOW custom job filing data
    https://github.com/NYCPlanning/db-developments/issues/386#issue-864138806

ingestion:
  source:
    type: s3
    bucket: edm-private
    key: dob_now/dob_now_job_applications/DOB_Now_Job_Filing_Data_for_DCP_{{ version }}.csv
  file_format:
    type: csv
    delimiter: \t
    encoding: cp1252
  processing_steps:
  - name: clean_column_names
    args: {"replace": {" ": "_", "-": "_"}, "lower": True}
  - name: coerce_column_types
    args:
      column_types: {
        "bin": "string",
        "total_construction_floor_area": "string",
        "proposedoccupancyclassification": "string",
        "horizontalenlargement": "string",
        "verticalenlargement": "string",
        "existing_height": "string",
        "proposed_height": "string",
        "initial_cost": "string",
        "existing_dwelling_units": "string",
        "latitude": "string",
        "longitude": "string",
        "existingbuildingheight": "string",
        "proposed_no_of_stories": "string",
        "existing_stories": "string",
        "proposed_zsf": "string",
        "existingoccupancyclassification": "string",
        "floor_area_ratio_(far)": "string",
        "proposed_dwelling_units": "string",
        "nta": "string",
        "proposedbuildingheight": "string",
        "no_of_parking_spaces": "string",
        "council_district": "string",
        "census_tract": "string",
        "use": "string",
        "block": "string",
        "lot": "string",
        "total_floor_area": "string",
        "enlargement_sq_footage": "string",
        "total_far": "string",
        "commmunity___board": "string",
      }
